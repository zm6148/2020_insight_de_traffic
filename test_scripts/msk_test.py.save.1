
from time import sleep
from json import dumps
from kafka import KafkaProducer


servers = ['b-1.traffickafka.sn43u9.c7.kafka.us-east-1.amazonaws.com:9092',
	   'b-2.traffickafka.sn43u9.c7.kafka.us-east-1.amazonaws.com:9092',
	   'b-3.traffickafka.sn43u9.c7.kafka.us-east-1.amazonaws.com:909'2

producer = KafkaProducer(bootstrap_servers=['b-1.traffickafka.sn43u9.c7.kafka.us-east-1.amazonaws.com:9092',
                                           'b-2.traffickafka.sn43u9.c7.kafka.us-east-1.amazonaws.com:9092',
                                           'b-3.traffickafka.sn43u9.c7.kafka.us-east-1.amazonaws.com:9092'],
			value_serializer=lambda x:
			dumps(x).encode('utf-8'))
print("connected")

for e in range(1000):
    data = {'number' : e}
    print(data)
    producer.send('numtest', value=data)
    print('sent')
    sleep(5)
